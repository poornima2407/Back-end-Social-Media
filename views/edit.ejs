<% include ./partials/header.ejs %>
<div class="cont py-2 px-3">
    <h1>Update your account</h1>
    <hr>
    <form action="/update" method="post">
      <div class="mb-3">
        <label for="exampleFormControlInput1" class="form-label">Username</label>
        <input id = "username" name="username" type="text" class="form-control" id="exampleFormControlInput1" placeholder="username" value="<%= foundUser.username %>">
      </div>
      <div class="mb-3">
        <label for="exampleFormControlInput1" class="form-label">Age</label>
        <input name="age" type="number" class="form-control" id="exampleFormControlInput1" placeholder="age" value="<%= foundUser.age %>">
      </div>
      
      <div class="mb-3">
        <label for="exampleFormControlInput1" class="form-label">Email</label>
        <input disabled name="email" type="email" class="form-control" id="exampleFormControlInput1" placeholder="email" value="<%= foundUser.email %>">
      </div>
      <button id="submit" type="submit" class="btn btn-warning">Update Account</button>
    </form>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.0/axios.min.js" integrity="sha512-aoTNnqZcT8B4AmeCFmiSnDlc4Nj/KPaZyB5G7JnOnUEkdNpCZs1LCankiYi01sLTyWy+m2P+W4XM+BuQ3Q4/Dg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    var user = document.querySelector("#username")
    user.addEventListener("input",function(){
        if(user.value.length>0){
            axios.get(`/check/${user.value}`)
            .then(function(data){
                if(data.data){
                    user.style.boxShadow = "0 0 0 0.25rem rgba(255,50,50,.7)"
                    document.querySelector("#submit").setAttribute("disabled",true)
                }
                else{
                    username.style.boxShadow = "0 0 0 0.25rem rgba(13,110,253,.25)";
                    document.querySelector('#submit').removeAttribute("disabled");
                }
            })
        }
    })
  </script>
<% include ./partials/footer.ejs %>